<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>اختبار نظام validation الصور</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
        }
        .success {
            color: #28a745;
            background-color: #d4edda;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }
        .error {
            color: #dc3545;
            background-color: #f8d7da;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }
        .info {
            color: #0c5460;
            background-color: #d1ecf1;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }
        input[type="file"] {
            margin: 10px 0;
            padding: 10px;
            border: 2px dashed #007bff;
            border-radius: 5px;
            width: 100%;
        }
        button {
            background-color: #007bff;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background-color: #0056b3;
        }
        .file-info {
            margin: 10px 0;
            padding: 10px;
            background-color: #f8f9fa;
            border-radius: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>🧪 اختبار نظام validation الصور</h1>
        <p>هذا الملف لاختبار نظام validation الصور مع حد 3 ميجابايت</p>

        <div class="test-section">
            <h2>📁 اختبار صورة واحدة</h2>
            <input type="file" id="singleFile" accept="image/*" />
            <button onclick="testSingleFile()">اختبار الصورة</button>
            <div id="singleResult"></div>
        </div>

        <div class="test-section">
            <h2>📁 اختبار صور متعددة</h2>
            <input type="file" id="multipleFiles" accept="image/*" multiple />
            <button onclick="testMultipleFiles()">اختبار الصور</button>
            <div id="multipleResult"></div>
        </div>

        <div class="test-section">
            <h2>ℹ️ معلومات النظام</h2>
            <div class="info">
                <strong>الحد الأقصى:</strong> 3 ميجابايت لكل صورة<br>
                <strong>الأنواع المدعومة:</strong> JPG, JPEG, PNG, GIF, WebP<br>
                <strong>الحد الأقصى للملفات:</strong> 10 ملفات في المرة الواحدة
            </div>
        </div>
    </div>

    <script>
        // محاكاة دوال validation
        function validateImageFile(file) {
            const maxSize = 3 * 1024 * 1024; // 3MB
            const allowedTypes = ['image/jpeg', 'image/jpg', 'image/png', 'image/gif', 'image/webp'];
            
            if (!allowedTypes.includes(file.type)) {
                return {
                    isValid: false,
                    errorMessage: `نوع الملف غير صحيح. الأنواع المسموحة: ${allowedTypes.join(', ')}`
                };
            }
            
            if (file.size > maxSize) {
                const sizeInMB = (file.size / (1024 * 1024)).toFixed(2);
                return {
                    isValid: false,
                    errorMessage: `حجم الصورة ${sizeInMB} ميجابايت يتجاوز الحد المسموح (3 ميجابايت)`
                };
            }
            
            return { isValid: true };
        }

        function validateImageFiles(files) {
            const maxFiles = 10;
            
            if (files.length > maxFiles) {
                return {
                    isValid: false,
                    errorMessage: `عدد الملفات كبير جداً. الحد الأقصى المسموح: ${maxFiles}`
                };
            }
            
            const invalidFiles = [];
            let firstOversizedSizeMB;
            
            for (const file of files) {
                const validation = validateImageFile(file);
                if (!validation.isValid) {
                    invalidFiles.push(file.name);
                    if (file.size > 3 * 1024 * 1024 && !firstOversizedSizeMB) {
                        firstOversizedSizeMB = (file.size / (1024 * 1024)).toFixed(2);
                    }
                }
            }
            
            if (invalidFiles.length > 0) {
                const names = invalidFiles.join(', ');
                const message = invalidFiles.length > 1
                    ? `الصور التالية تتجاوز الحد المسموح (3 ميجابايت): ${names}`
                    : `الصورة "${names}" (${firstOversizedSizeMB} ميجابايت) تتجاوز الحد المسموح (3 ميجابايت)`;
                
                return {
                    isValid: false,
                    errorMessage: message,
                    invalidFiles
                };
            }
            
            return { isValid: true };
        }

        function testSingleFile() {
            const fileInput = document.getElementById('singleFile');
            const resultDiv = document.getElementById('singleResult');
            
            if (fileInput.files.length === 0) {
                resultDiv.innerHTML = '<div class="error">يرجى اختيار صورة أولاً</div>';
                return;
            }
            
            const file = fileInput.files[0];
            const validation = validateImageFile(file);
            
            let html = '<div class="file-info">';
            html += `<strong>اسم الملف:</strong> ${file.name}<br>`;
            html += `<strong>النوع:</strong> ${file.type}<br>`;
            html += `<strong>الحجم:</strong> ${(file.size / (1024 * 1024)).toFixed(2)} ميجابايت<br>`;
            html += '</div>';
            
            if (validation.isValid) {
                html += '<div class="success">✅ الصورة صالحة ويمكن رفعها</div>';
            } else {
                html += `<div class="error">❌ ${validation.errorMessage}</div>`;
            }
            
            resultDiv.innerHTML = html;
        }

        function testMultipleFiles() {
            const fileInput = document.getElementById('multipleFiles');
            const resultDiv = document.getElementById('multipleResult');
            
            if (fileInput.files.length === 0) {
                resultDiv.innerHTML = '<div class="error">يرجى اختيار صور أولاً</div>';
                return;
            }
            
            const files = Array.from(fileInput.files);
            const validation = validateImageFiles(files);
            
            let html = '<div class="file-info">';
            html += `<strong>عدد الملفات:</strong> ${files.length}<br>`;
            html += '<strong>تفاصيل الملفات:</strong><br>';
            files.forEach((file, index) => {
                html += `${index + 1}. ${file.name} - ${(file.size / (1024 * 1024)).toFixed(2)} ميجابايت<br>`;
            });
            html += '</div>';
            
            if (validation.isValid) {
                html += '<div class="success">✅ جميع الصور صالحة ويمكن رفعها</div>';
            } else {
                html += `<div class="error">❌ ${validation.errorMessage}</div>`;
                if (validation.invalidFiles) {
                    html += `<div class="error"><strong>الملفات غير الصالحة:</strong> ${validation.invalidFiles.join(', ')}</div>`;
                }
            }
            
            resultDiv.innerHTML = html;
        }

        // إضافة مستمعات الأحداث
        document.getElementById('singleFile').addEventListener('change', function() {
            if (this.files.length > 0) {
                testSingleFile();
            }
        });

        document.getElementById('multipleFiles').addEventListener('change', function() {
            if (this.files.length > 0) {
                testMultipleFiles();
            }
        });
    </script>
</body>
</html>
